---
title: "2017 Statistics Midterm Exam1"
author: "地理二 B06208001 龔泓愷"
date: "2018年10月14日"
output: html_document
---
##Q1
台北市某高中一行共 5 人，放學後相約在學校門口旁的
自行車租借站(A 站)，結伴騎乘公共自行車，到西門町(租借站 B 站)聚餐與逛街。   

已知 1：    
A 站有 20 個車位，每個車位有腳踏車的機率為 0.2；    
B 站有 40 個車位，每個車位有腳踏車的機率為 0.1。    
每個車位有無停放腳踏車皆是一個獨立事件。    

已知 2：    
台北市所有流通的公共自行車共有 200 輛，其中 5% 有輕微損壞(仍租借使用)。   
校方為了確保學生的交通安全，與自行車租賃業者合作進行調查，    
發現在所有輕微損壞的自行車中，有 10% 會出現在該校門口旁的 A 站。  

a. 這 5 位好友每個人同時都能在 A 站借車，且在 B 站能同時還車的機率。    
腳踏車是否能借為二項分布。    
A = 五人都能在A站借到車的機率 = P(A可借 >= 5) = 1 - P(A可借<= 4)          
B = 五人都能在B站還到車的機率 = P(B可還 >= 5) = 1 - P(B可還<= 4)          
```{r}
A = pbinom(4, size = 20, prob = 0.2, lower.tail = F)
B = pbinom(4, size = 40, prob = 0.9, lower.tail = F)
A * B
```

**5 位好友每個人同時都能在 A 站借車，且在 B 站能同時還車的機率0.3703517**。   
<br>

b. 小明在 A 站會租到輕微損壞自行車的機率。    
A = A站有腳踏車   
B = 有壞的腳踏車    
P(A) = 20 * 0.2 /200 = 0.02   
P(B) = 0.05       
P(A|B) = 0.1    
題目為P(B|A) = P(A|B) * P(B) / P(A)
```{r}
0.1 * 0.05 / 0.02
```

**小明在 A 站會租到輕微損壞自行車的機率0.25**。   
<br>

c. 這 5 位好友中有 2 人在 A 站剛好租到輕微損壞自行車的機率。
```{r}
dbinom(2, size = 5, prob = 0.25)
```

**這 5 位好友中有 2 人在 A 站剛好租到輕微損壞自行車的機率為0.2636719**   
<br>

##Q2

世貿捷運站晚上的每小時進出站人數是呈現常態分布。    
進站人數 (平均=80，標準差=5)；岀站人數 (平均=30，標準差=3)，    
且每小時的進出站人數互相獨立。    

a. 該捷運站的設計容量是以每小時停留站內的平均人數加上 3 倍標準差。    
計算該站可容納的人數。 (假設：站內人數 = 進站人數 – 出站人數)   

因為進站人數與出站人數皆為常態分佈，站內人數亦為常態分佈。
mean(站內人數) = 80 - 30 = 50
sd(站內人數) = sqrt(5^2 + 3^2) = 5.830952
```{r}
sd = sqrt(5^2 + 3^2)
50 + 3 * sd
```

**該站可容納的人數為67人**   
<br>

b. 為了因應跨年晚會人潮湧入捷運站，捷運局預估當晚每小時的進站人數會是平
日的 3 倍，而每小時出站人數則為平日的 0.5 倍。定義跨年尖峰站內人數為當晚
每小時站內的平均人數加上 3 倍標準差。計算該站的跨年尖峰站內人數。

當晚每小時進站人數 = 80 * 3 = 240   
其標準差為5 * 3 = 15      
當晚每小時出站人數 = 30 * 0.5 = 15      
其標準差為3 * 0.5 = 1.5     

當晚每小時站內人數 = 240 - 15 = 225       
其標準差為sqrt(15^2 + 1.5^2) = 15.0741    
```{r}
sd = sqrt(15^2 + 1.5^2)
225 + 3 * sd
```

**該站的跨年尖峰站內人數為270人** 
<br>

c. 捷運局認為，若該站每小時站內人數超過 200 人，就需要加派人力引導疏散。    
請分別計算在平日晚上和跨年晚會，該站需要加派人力的機率。    

```{r}
pnorm(200, mean = 50, sd = 5.830952, lower.tail = F)
pnorm(200, mean = 225, sd = 15.0741, lower.tail = F)
```

**平日晚上和跨年晚會，該站需要加派人力的機率分別為3.08695e-146與0.9513891**
<br>

##Q3
定義：每天遭竊率 (%) = (每天遭竊人數 / 總人口數) x 100%   
< 10% 良好 10%-30% 普通 31%-70% 不良 > 70% 危險   
若某城市有 100 萬人口，每人每天會遭竊的機率 0.01。    

a. 協助繪製該城市「每天遭竊人數」的機率分布圖 (probability distribution
function, PDF)，並分別以綠色、藍色、黃色和紅色在圖上標示出「良好」、「普
通」、「不良」、「危險」等區間。    

是否遭竊為二項分布。    
A良好為 < 100000 人被竊。     
B普通為 100000 ~ 300000 人被竊。   
C不良為 300000 ~ 700000 人被竊。   
D危險為 > 700000 人被竊。    

```{r warning = F}
xx = c(9000:11000)
yy = dbinom(xx, size = 1000000, prob = 0.01)
plot(x = xx, y = yy, type = "l", main = "每天遭竊人數", xlab = '遭竊人數', ylab = '機率')

region.x = xx[xx<=100000]
region.y = yy[xx<=100000]
	
region.x2 = c(head(region.x,1), region.x, tail(region.x,1))
region.y2 = c(0, region.y, 0)
	
polygon(region.x2, region.y2, col = "green")
```

**因為平均遭竊人數遠小於安全標準，不必要畫其他區域**
<br>

b. 模擬在一年(365 天)中的「每天遭竊人數」，並計算在這一年當中，「每天遭竊人   
數」會超出離群值(outlier)的日數。     
```{r}
data = rbinom(365, size = 1000000, prob = 0.01)
Q1T <- quantile(data)[2] - 1.5 * IQR(data)
Q3T <- quantile(data)[4] + 1.5 * IQR(data)
count = 0
for (i in 1:365){
  if (data[i] < Q1T|data[i] > Q3T)
    count = count + 1
}
count
```

**會超出離群值(outlier)的日數為上面(count)的天數**
<br>

c. 若該城市警察加強巡邏，將每人每天會遭竊的機率降低為 0.001。   
重新繪製 a 小題的機率分布圖，並比較與描述兩張統計圖的差異。  
```{r warning = F}
xx = c(0:2000)
yy = dbinom(xx, size = 1000000, prob = 0.001)
plot(x = xx, y = yy, type = "l", main = "每天遭竊人數", xlab = '遭竊人數', ylab = '機率')

region.x = xx[xx<=100000]
region.y = yy[xx<=100000]
	
region.x2 = c(head(region.x,1), region.x, tail(region.x,1))
region.y2 = c(0, region.y, 0)
	
polygon(region.x2, region.y2, col = "green")
```

**竊盜率更低，與(a)比較中心位置轉變，且標準差更小(X軸同樣為2000)**
<br>

##Q4
經長期的氣象統計資料，某城市出現晴天的機率為 0.7，雨天的機率為 0.3。    
預報為雨天，但隔天是晴天的機率為 0.2；    
預報為晴天，但隔天是雨天的機率為 0.1。    
氣象局定義「預報準確率」(%) = (預報正確的次數/所有預報的次數) x 100%  

a. 計算該城市氣象局的「預報準確率」。   

定義：    

  * 實際為晴天: A   
  * 實際為雨天: AC    
  * 預報為晴天: B   
  * 預報為雨天: BC  
  
已知機率：    

  * P(A) = 0.7    
  * P(AC) = 0.3   
  * P(A|BC) = 0.2   
  * P(AC|B) = 0.1   


. |A      |AC     |.      
--|-------|-------|---    
**B** |0.7 -y |x+y-0.7|x      
**BC**|y      |1-x-y  |1-x    
. |0.7    |0.3    |.      

聯立求得x = 5/7，y = 2/35   
其中預報準確為P(A&B)與P(AC&BC)    
```{r}
x = 5/7
y = 2/35
0.7 - y + 1- x - y
```
**預報準確率為0.8714286**

<br>

b.計算一週內（7 天）至少有一天氣象預報錯誤的機率。    
氣象預報正確與否為二項分布。
```{r}
p = 0.7 - y + 1- x - y
pbinom(0, size = 7, prob = 1-p, lower.tail = F)
```
**一週內（7 天）至少有一天氣象預報錯誤的機率為0.6183875**   

<br>

##Q5

時間  |10~14  |14~16  |16~21  
------|-------|-------|------      
銷售量|60/4hrs|30/2hrs|75/5hrs    
每一分鐘賣出一杯|(60/4)/60 = 0.25|(30/2)/60 = 0.25|(75/5)/60 = 0.25
每一分鐘賣出一杯珍珠|0.25*0.6 = 0.15|0.25*0.6 = 0.15|0.25*0.6 = 0.15
長期統計亦發現，任一時段皆有 60%的銷售量為含有珍珠的品項。    
老闆每天準備的珍珠量，可製作 75 杯飲品。假設每個時段的銷售是獨立事件。   

a. 某人在 17:30 下班，已買不到珍珠奶茶的機率。    
能否買到珍珠為二項分布。      
不能買到珍珠，代表17:30至少已賣出75杯珍珠飲料：P(>=75) = 1 - P(<=74)
```{r}
1 - pbinom(75, size = 7*60+30, prob = 0.15)
```

**已買不到珍珠奶茶的機率為0.1457492**

b. 每天的午休時間有 20 分鐘，其銷售量較高，平均是 24 / hour。
請繪製午休時間銷售量的機率分佈圖

20分鐘賣出8杯 > 每一分賣出一杯機率為0.4     
```{r}
yy = dbinom(c(0:20), size = 20, prob = 0.4)
barplot(yy, names.arg=c(0:20), space = 0, main = "午休時間銷售量的機率分佈圖", xlab = '賣出杯數', ylab = '機率')
```